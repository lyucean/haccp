#!/bin/bash

echo "üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ PHP –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–æ –≤–µ—Ä—Å–∏–∏ 8.3"
echo "=========================================="
echo ""

# –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
cd /var/www/haccpro.ru

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä PHP
echo "1Ô∏è‚É£ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä PHP..."
docker compose stop php-fpm

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
echo "2Ô∏è‚É£ –£–¥–∞–ª—è—é —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä PHP..."
docker compose rm -f php-fpm

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å PHP 8.3
echo "3Ô∏è‚É£ –ó–∞–ø—É—Å–∫–∞—é –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å PHP 8.3..."
docker compose --profile prod up -d php-fpm

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
echo "4Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è—é —Å—Ç–∞—Ç—É—Å..."
docker compose ps php-fpm

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é PHP
echo "5Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è—é –≤–µ—Ä—Å–∏—é PHP..."
docker exec haccpro-php php -v

echo ""
echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
